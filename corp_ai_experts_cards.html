<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Our Grey‑Hair Experts | Corporate AI Solutions</title>
  <meta name="description" content="Meet the seasoned executives and domain specialists behind Corporate AI Solutions. Grey‑hair wisdom powering pragmatic AI adoption." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0b1020;--bg2:#0f172a;--card:#111827;--muted:#94a3b8;--text:#e5e7eb;--headline:#f8fafc;--brand:#60a5fa;--brand2:#22d3ee;--accent:#a78bfa;--radius:16px;--shadow:0 10px 30px rgba(0,0,0,.35);--grid:1200px}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:radial-gradient(1200px 600px at 20% -10%, rgba(96,165,250,.15), transparent),radial-gradient(900px 500px at 110% 10%, rgba(34,211,238,.12), transparent),linear-gradient(180deg,var(--bg),var(--bg2));color:var(--text);line-height:1.65;-webkit-font-smoothing:antialiased}
    a{color:var(--brand)}
    header{position:sticky;top:0;z-index:50;backdrop-filter:blur(8px);background:linear-gradient(180deg,rgba(11,16,32,.85),rgba(11,16,32,.35));border-bottom:1px solid rgba(148,163,184,.1)}
    .nav{max-width:var(--grid);margin:auto;padding:14px 20px;display:flex;align-items:center;gap:14px}
    .logo{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--headline);font-weight:800}
    .logo-mark{width:28px;height:28px;border-radius:9px;background:conic-gradient(from 210deg,var(--brand),var(--brand2),var(--accent),var(--brand));box-shadow:0 8px 24px rgba(96,165,250,.35)}
    .spacer{flex:1}
    .nav a{color:var(--text);text-decoration:none;font-weight:600;opacity:.9}
    .nav a:hover{opacity:1}
    .btn{display:inline-flex;align-items:center;gap:10px;padding:10px 16px;border-radius:999px;text-decoration:none;font-weight:700;background:linear-gradient(135deg,var(--brand),var(--brand2));color:#020617;box-shadow:0 10px 24px rgba(34,211,238,.25);cursor:pointer;border:none;transition:all 0.2s}
    .btn:hover{transform:translateY(-1px)}
    .btn:disabled{opacity:0.6;cursor:not-allowed;transform:none}
    .btn.secondary{background:transparent;color:var(--text);border:1px solid rgba(148,163,184,.25);box-shadow:none}
    .btn.ai{background:linear-gradient(135deg,var(--accent),#ec4899);color:white;box-shadow:0 10px 24px rgba(167,139,250,.25)}

    .wrap{max-width:var(--grid);margin:auto;padding:0 20px}
    .hero{padding:64px 0 24px}
    h1{margin:0 0 10px;font-size:clamp(32px,6vw,52px);line-height:1.05;color:var(--headline)}
    .lead{color:var(--muted);font-size:clamp(16px,2.2vw,20px)}

    section{padding:38px 0}
    h2{margin:0 0 10px;font-size:clamp(24px,4vw,34px);color:var(--headline)}

    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    @media(max-width:1100px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:730px){.grid{grid-template-columns:1fr}}

    .card{display:flex;flex-direction:column;gap:12px;background:linear-gradient(180deg,rgba(17,24,39,.9),rgba(17,24,39,.6));border:1px solid rgba(148,163,184,.12);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .head{display:flex;gap:14px;padding:16px}
    .avatar{flex:0 0 84px;width:84px;height:84px;border-radius:12px;background:#0a0f22;border:1px solid rgba(148,163,184,.15);object-fit:cover}
    .name{margin:2px 0 2px;color:var(--headline);font-size:18px;font-weight:800}
    .title{margin:0;color:#cbd5e1;font-size:13px}
    .tags{display:flex;flex-wrap:wrap;gap:8px;padding:0 16px 12px}
    .tag{font-size:12px;border:1px solid rgba(148,163,184,.25);color:var(--text);padding:4px 8px;border-radius:999px;background:rgba(2,6,23,.35)}
    .bio{padding:0 16px 16px;color:#94a3b8;font-size:14px}

    .links{display:flex;gap:10px;padding:0 16px 16px}
    .link{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;border:1px solid rgba(148,163,184,.25);text-decoration:none;color:var(--text);font-weight:600}
    .link:hover{border-color:rgba(96,165,250,.6)}

    .filterbar{display:flex;flex-wrap:wrap;gap:10px;margin:10px 0 0}
    .filterbar input{width:280px;max-width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(148,163,184,.25);background:#0f172a;color:var(--text)}

    footer{padding:28px 0 48px;border-top:1px solid rgba(148,163,184,.15);background:linear-gradient(180deg,rgba(2,6,23,.35),rgba(2,6,23,.65))}
    .foot{display:grid;grid-template-columns:1.2fr .8fr;gap:18px}
    @media(max-width:980px){.foot{grid-template-columns:1fr}}
    .small{font-size:13px;color:var(--muted)}

    /* Admin/self-serve panel */
    .panel{background:linear-gradient(180deg,rgba(17,24,39,.85),rgba(17,24,39,.6));border:1px solid rgba(148,163,184,.18);border-radius:16px;box-shadow:var(--shadow);padding:16px}
    .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .input{width:280px;max-width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(148,163,184,.25);background:#0f172a;color:var(--text);resize:vertical}
    .drop{border:2px dashed rgba(148,163,184,.35);border-radius:12px;padding:16px;text-align:center;background:rgba(2,6,23,.35)}
    .admin-tools{display:none;margin-top:6px}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid rgba(148,163,184,.25)}
    .danger{color:#fecaca;border-color:#fecaca33}

    /* AI Generation styles */
    .explanation{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);border-radius:12px;padding:16px;margin:16px 0}
    .ai-section{background:rgba(167,139,250,.1);border:1px solid rgba(167,139,250,.3);border-radius:12px;padding:16px;margin:16px 0}
    .loading{display:none;align-items:center;gap:8px;color:var(--accent)}
    .spinner{width:16px;height:16px;border:2px solid rgba(167,139,250,.3);border-top:2px solid var(--accent);border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)}}

    /* Tab system */
    .tabs{display:flex;gap:4px;margin:16px 0;background:rgba(17,24,39,.5);padding:4px;border-radius:12px}
    .tab{padding:8px 16px;border-radius:8px;background:transparent;border:none;color:var(--muted);cursor:pointer;font-weight:500;transition:all 0.2s}
    .tab.active{background:var(--brand);color:#020617}
    .tab-content{display:none}
    .tab-content.active{display:block}

    /* Image management */
    .upload-zone{border:2px dashed rgba(148,163,184,.35);border-radius:12px;padding:32px;text-align:center;background:rgba(2,6,23,.35);cursor:pointer;margin:16px 0;transition:all 0.3s}
    .upload-zone:hover{border-color:var(--brand)}
    .upload-zone.dragover{border-color:var(--brand2);background:rgba(34,211,238,.1)}
    .preview-image{width:120px;height:120px;border-radius:12px;object-fit:cover;border:2px solid rgba(148,163,184,.25)}
    .avatar-generator{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin:16px 0}
    .avatar-option{width:80px;height:80px;border-radius:12px;cursor:pointer;border:2px solid transparent;transition:all 0.2s}
    .avatar-option:hover{border-color:var(--brand)}
    .avatar-option.selected{border-color:var(--brand2);box-shadow:0 0 0 2px rgba(34,211,238,.3)}
    .hidden{display:none!important}

    /* Form styles */
    .form-group{margin:16px 0}
    .form-group label{display:block;margin-bottom:8px;font-weight:600;color:var(--headline)}
    .help-text{font-size:12px;color:var(--muted);margin-top:6px;line-height:1.4}
    .wide-input{width:100%!important}
    .preview-card{background:rgba(17,24,39,.7);border:1px solid rgba(148,163,184,.15);border-radius:12px;padding:20px;margin-top:20px}
    .feature-highlight{background:rgba(34,211,238,.1);border-left:4px solid var(--brand2);padding:16px;margin:16px 0;border-radius:0 8px 8px 0}
  </style>
</head>
<body>
  <header>
    <nav class="nav">
      <a class="logo" href="/" aria-label="Corporate AI Solutions home">
        <span class="logo-mark" aria-hidden="true"></span>
        <span>Corporate <span style="opacity:.8">AI</span> Solutions</span>
      </a>
      <div class="spacer"></div>
      <a href="/">Home</a>
      <a href="/about/">About</a>
      <a href="/join/">Join Us</a>
      <a href="/products/">Products</a>
      <a href="https://corporateaisolutions.com/offerings/">Offerings</a>
      <a href="/blog/">Blog</a>
      <a href="/contact/" class="btn secondary">Contact</a>
      <a href="https://calendly.com/mcmdennis/15min" class="btn" target="_blank" rel="noopener">Get Started</a>
    </nav>
  </header>

  <main>
    <section class="wrap hero">
      <h1>Meet Our Grey‑Hair Experts</h1>
      <p class="lead">Seasoned executives and domain specialists who bring the judgment, networks, and context that make AI succeed in the real world.</p>
      <div class="filterbar">
        <input id="search" type="search" placeholder="Search by name, title, or expertise…" aria-label="Search experts" />
      </div>
    </section>

    <!-- Create Card / Admin & Invite Panel -->
    <section class="wrap" id="create-panel" style="display:none; margin-top:-10px;">
      <div class="panel">
        <div class="row" style="justify-content:space-between;">
          <h2 style="margin:0;">Create Expert Card</h2>
          <div class="row">
            <button id="adminUnlockBtn" class="btn secondary">Admin Unlock</button>
            <button id="inviteUnlockBtn" class="btn secondary">Have Invite Code?</button>
          </div>
        </div>

        <!-- Unlock bars -->
        <div id="adminUnlockBar" style="display:none;margin-top:12px;" class="row">
          <input id="adminPass" type="password" placeholder="Enter Admin Passcode" class="input"/>
          <button id="adminPassGo" class="btn">Unlock</button>
          <span id="adminStatus" class="small"></span>
        </div>
        <div id="inviteUnlockBar" style="display:none;margin-top:12px;" class="row">
          <input id="inviteCode" type="password" placeholder="Enter Invite Code" class="input"/>
          <button id="inviteGo" class="btn">Continue</button>
          <span id="inviteStatus" class="small"></span>
        </div>

        <!-- AI Profile Generation Section -->
        <div id="profileCreationSection" style="display:none;">
          <div class="explanation">
            <h3>🤖 Why AI-Powered Profile Creation?</h3>
            <p><strong>We'd love to auto-import from LinkedIn, but:</strong></p>
            <ul style="margin:8px 0; padding-left:20px;">
              <li><strong>LinkedIn's Terms</strong> prohibit automated scraping</li>
              <li><strong>API approval</strong> can take months with strict limitations</li>
              <li><strong>Manual copying</strong> would be tedious and error-prone</li>
            </ul>
            <p><strong>Solution:</strong> Our AI analyzes your LinkedIn content and creates a tailored Corporate AI Solutions expert profile in seconds! ✨</p>
          </div>

          <div class="ai-section">
            <h3>🚀 AI Profile Generator</h3>
            <p>Paste your LinkedIn profile content below, and our AI will create a professional expert profile tailored for our corporate AI consulting network.</p>
            
            <div class="feature-highlight">
              <strong>💡 How it works:</strong> Our AI extracts relevant experience, emphasizes corporate AI expertise, and formats everything for maximum professional impact.
            </div>

            <div class="form-group">
              <label for="linkedinContent">Your LinkedIn Profile Content</label>
              <textarea 
                id="linkedinContent" 
                class="input wide-input" 
                rows="8" 
                placeholder="Copy and paste your LinkedIn profile content here...

For best results, include:
• Your name and current title
• About/Summary section 
• Current and recent work experience
• Key skills and expertise areas
• Education (if relevant)

Go to your LinkedIn profile, select all (Ctrl+A / Cmd+A), copy, then paste here."
              ></textarea>
              <div class="help-text">
                <strong>Tip:</strong> Open LinkedIn in another tab, go to your profile, select all text, and paste it here. The AI will extract what's relevant.
              </div>
            </div>

            <div class="row">
              <button type="button" class="btn ai" onclick="generateAIProfile()" id="generateBtn">
                ✨ Generate AI Profile
              </button>
              <button type="button" class="btn secondary" onclick="openLinkedIn()">🔗 Open LinkedIn</button>
              <div class="loading" id="loadingIndicator">
                <div class="spinner"></div>
                <span>AI is crafting your profile...</span>
              </div>
            </div>
          </div>

          <!-- Generated Profile Form -->
          <div id="generatedProfileForm" style="display:none;">
            <h3>🎉 Your AI-Generated Profile</h3>
            <p style="color:var(--muted); margin-bottom:16px;">Review and edit your AI-generated profile below:</p>
            
            <div class="tabs">
              <button class="tab active" onclick="switchFormTab('basic')">📝 Basic Info</button>
              <button class="tab" onclick="switchFormTab('image')">🖼️ Profile Image</button>
              <button class="tab" onclick="switchFormTab('preview')">👀 Preview</button>
            </div>

            <!-- Basic Info Tab -->
            <div id="basic-tab" class="tab-content active">
              <div class="row" style="gap:16px; align-items:flex-start;">
                <div class="form-group" style="flex:1;">
                  <label for="ai_name">Name *</label>
                  <input type="text" id="ai_name" class="input wide-input" required />
                </div>
                <div class="form-group" style="flex:1;">
                  <label for="ai_title">Title *</label>
                  <input type="text" id="ai_title" class="input wide-input" required />
                </div>
              </div>
              
              <div class="form-group">
                <label for="ai_expertise">Expertise Areas</label>
                <input type="text" id="ai_expertise" class="input wide-input" />
                <div class="help-text">Comma-separated list (e.g., AI Strategy, Digital Transformation, Enterprise Technology)</div>
              </div>
              
              <div class="form-group">
                <label for="ai_bio">Corporate AI Solutions Bio</label>
                <textarea id="ai_bio" class="input wide-input" rows="5"></textarea>
                <div class="help-text">AI-generated bio tailored for our corporate AI consulting network - edit as needed</div>
              </div>
              
              <div class="row" style="gap:16px; align-items:flex-start;">
                <div class="form-group" style="flex:1;">
                  <label for="ai_linkedin">LinkedIn URL</label>
                  <input type="url" id="ai_linkedin" class="input wide-input" />
                </div>
                <div class="form-group" style="flex:1;">
                  <label for="ai_email">Email</label>
                  <input type="email" id="ai_email" class="input wide-input" />
                </div>
              </div>

              <div class="row" style="margin-top:16px;">
                <button type="button" class="btn" onclick="switchFormTab('image')">Next: Add Profile Image →</button>
                <button type="button" class="btn secondary" onclick="regenerateAIProfile()">🔄 Regenerate Profile</button>
              </div>
            </div>

            <!-- Image Tab -->
            <div id="image-tab" class="tab-content">
              <h3>🖼️ Profile Image Options</h3>
              
              <div class="tabs" style="margin:16px 0;">
                <button class="tab active" onclick="switchImageTab('upload')">📁 Upload</button>
                <button class="tab" onclick="switchImageTab('generate')">🎨 Generate</button>
                <button class="tab" onclick="switchImageTab('url')">🔗 URL</button>
              </div>

              <!-- Upload Image -->
              <div id="upload-img-tab" class="tab-content active">
                <div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()">
                  <input type="file" id="fileInput" accept="image/*" class="hidden" onchange="handleFileSelect(event)">
                  <div id="uploadContent">
                    <div style="font-size:48px;margin-bottom:16px;">📸</div>
                    <p style="margin:8px 0;font-weight:600;">Click to upload or drag image here</p>
                    <p style="margin:0;font-size:12px;color:var(--muted);">JPG, PNG, WebP supported</p>
                  </div>
                  <div id="imagePreview" class="hidden">
                    <img id="previewImg" class="preview-image" alt="Preview">
                    <p style="margin:8px 0 0;">✅ Image ready to use</p>
                  </div>
                </div>
              </div>

              <!-- Generate Avatar -->
              <div id="generate-img-tab" class="tab-content">
                <div style="margin:16px 0;">
                  <div class="row">
                    <input type="text" placeholder="Your initials (e.g., JD)" id="initialsInput" class="input" style="width:200px;" maxlength="3">
                    <button class="btn" onclick="generateAvatars()">Generate Avatars</button>
                  </div>
                </div>
                <div class="avatar-generator" id="avatarOptions"></div>
              </div>

              <!-- Photo URL -->
              <div id="url-img-tab" class="tab-content">
                <div style="margin:16px 0;">
                  <div class="form-group">
                    <label for="photoUrlInput">Image URL</label>
                    <input type="url" id="photoUrlInput" class="input wide-input" placeholder="https://example.com/photo.jpg">
                    <div class="help-text">Right-click any web image and select "Copy image address"</div>
                  </div>
                  <button class="btn" onclick="testPhotoUrl()">Test & Use URL</button>
                  <div id="urlPreview" class="hidden" style="text-align:center;margin-top:16px;">
                    <img id="urlPreviewImg" class="preview-image" alt="URL Preview">
                    <p style="margin-top:8px;">✅ Image loaded successfully</p>
                  </div>
                </div>
              </div>

              <input type="hidden" id="ai_photo" />
              
              <div class="row" style="margin-top:20px;">
                <button type="button" class="btn" onclick="switchFormTab('preview')">Next: Preview Profile →</button>
                <button type="button" class="btn secondary" onclick="switchFormTab('basic')">← Back to Basic Info</button>
              </div>
            </div>

            <!-- Preview Tab -->
            <div id="preview-tab" class="tab-content">
              <h3>👀 Profile Preview</h3>
              <div id="profilePreviewContent" class="preview-card">
                <!-- Preview will be generated here -->
              </div>
              
              <div class="row" style="margin-top:20px;">
                <button type="button" class="btn" onclick="finalizeProfile()">✅ Perfect! Add to Network</button>
                <button type="button" class="btn secondary" onclick="switchFormTab('basic')">✏️ Edit Profile</button>
                <button type="button" class="btn secondary" onclick="copyProfileJSON()">📋 Copy JSON</button>
                <button type="button" class="btn secondary" onclick="startOver()">🔄 Start Over</button>
              </div>
            </div>
          </div>

          <!-- Manual Entry Fallback -->
          <div id="manualEntrySection" style="display:none; margin-top:20px;">
            <h3>✏️ Manual Entry</h3>
            <p>If AI generation fails, you can create your profile manually:</p>
            
            <div class="row" style="gap:16px; align-items:flex-start;">
              <div class="form-group" style="flex:1;">
                <label for="manual_name">Name *</label>
                <input type="text" id="manual_name" class="input" required />
              </div>
              <div class="form-group" style="flex:1;">
                <label for="manual_title">Title *</label>
                <input type="text" id="manual_title" class="input" required />
              </div>
            </div>
            
            <div class="form-group">
              <label for="manual_expertise">Expertise Areas</label>
              <input type="text" id="manual_expertise" class="input wide-input" />
              <div class="help-text">Comma-separated list</div>
            </div>
            
            <div class="form-group">
              <label for="manual_bio">Professional Bio</label>
              <textarea id="manual_bio" class="input wide-input" rows="4"></textarea>
            </div>
            
            <div class="row" style="gap:16px; align-items:flex-start;">
              <div class="form-group" style="flex:1;">
                <label for="manual_linkedin">LinkedIn URL</label>
                <input type="url" id="manual_linkedin" class="input" />
              </div>
              <div class="form-group" style="flex:1;">
                <label for="manual_email">Email</label>
                <input type="email" id="manual_email" class="input" />
              </div>
            </div>
            
            <div class="form-group">
              <label for="manual_photo">Photo URL</label>
              <input type="url" id="manual_photo" class="input wide-input" />
            </div>

            <button type="button" class="btn" onclick="previewManualProfile()">👀 Preview Profile</button>
          </div>

        </div>

        <!-- Original drag & drop section (hidden when AI is active) -->
        <div id="originalDropSection" style="display:none;">
          <div class="drop" style="margin-top:16px;">
            Drag a LinkedIn profile link here (or paste below)
            <div class="row" style="margin-top:10px;justify-content:center;">
              <input id="linkedinInput" type="url" placeholder="https://www.linkedin.com/in/..." class="input" style="width:420px;"/>
              <button id="prefillBtn" class="btn">Prefill</button>
            </div>
            <p class="small" style="margin-top:8px;color:var(--muted)">We don't scrape LinkedIn in the browser. This just seeds the form; you can edit.</p>
          </div>

          <!-- Original form -->
          <form id="expertForm" style="margin-top:16px;">
            <div class="row" style="gap:12px;align-items:flex-start;flex-wrap:wrap;">
              <label class="small" style="display:flex;flex-direction:column;gap:6px;">Name <input id="f_name" required class="input"></label>
              <label class="small" style="display:flex;flex-direction:column;gap:6px;">Title <input id="f_title" required class="input"></label>
              <label class="small" style="display:flex;flex-direction:column;gap:6px;">Expertise (comma‑separated) <input id="f_expertise" placeholder="Construction, Compliance, AI Strategy" class="input"></label>
              <label class="small" style="display:flex;flex-direction:column;gap:6px;">Photo URL <input id="f_photo" placeholder="https://..." class="input"></label>
              <label class="small" style="display:flex;flex-direction:column;gap:6px;">LinkedIn URL <input id="f_linkedin" type="url" placeholder="https://www.linkedin.com/in/..." class="input"></label>
              <label class="small" style="display:flex;flex-direction:column;gap:6px;">Email <input id="f_email" type="email" placeholder="name@company.com" class="input"></label>
            </div>
            <label class="small" style="display:block;margin-top:12px;">Short Bio
              <textarea id="f_bio" rows="4" class="input wide-input"></textarea>
            </label>
            <div class="row" style="margin-top:12px;">
              <button id="addCardBtn" class="btn" type="submit">Add Card (Preview)</button>
              <button id="copyJsonBtn" class="btn secondary" type="button">Copy JSON</button>
              <button id="downloadJsonBtn" class="btn secondary" type="button">Download JSON</button>
              <span class="small" id="saveHint" style="display:none;">Copied! Paste this object into the <code>experts</code> array or your backend.</span>
            </div>
          </form>
        </div>

        <!-- Admin tools -->
        <div class="admin-tools" id="adminTools">
          <div class="row" style="margin-top:10px;gap:10px;">
            <span class="pill">Local preview: <strong id="localCount">0</strong> item(s)</span>
            <button id="exportAllBtn" class="btn secondary" type="button">Export ALL (base + local)</button>
            <button id="clearLocalBtn" class="btn secondary danger" type="button" title="Clear local preview additions">Clear Local</button>
          </div>
        </div>
      </div>
    </section>

    <section class="wrap" id="experts">
      <div class="grid" id="grid"></div>
      <p class="small" style="margin-top:10px">Want to join this network? <a href="/join/">Learn more and apply</a> or email <a href="mailto:dennis@corporateaisolutions.com">dennis@corporateaisolutions.com</a>.</p>
    </section>
  </main>

  <footer>
    <div class="wrap foot">
      <div>
        <div class="logo" style="margin-bottom:8px"><span class="logo-mark"></span><span>Corporate <span style="opacity:.8">AI</span> Solutions</span></div>
        <p class="small">Grey‑hair wisdom × modern AI engineering. Outcome‑driven automation with governance and adoption built‑in.</p>
      </div>
      <div>
        <h3 style="margin:0 0 8px;color:var(--headline);font-size:18px">Contact</h3>
        <p class="small">📧 <a href="mailto:dennis@corporateaisolutions.com">dennis@corporateaisolutions.com</a><br>📞 <a href="tel:+61402612471">+61 402 612 471</a><br>🌐 <a href="https://corporateaisolutions.com/offerings/">corporateaisolutions.com/offerings</a></p>
        <p class="small">© <span id="y"></span> Corporate AI Solutions.</p>
      </div>
    </div>
  </footer>

  <script>
    // ===== Base seed data =====
    const BASE_EXPERTS = [
      {
        name: "Dennis McMahon",
        title: "Founder · Operator & Advisor",
        expertise: ["Construction", "Modular/Prefab", "Go‑to‑Market", "AI Strategy"],
        photo: "https://corporateaisolutions.com/wp-content/uploads/2024/11/Screenshot-2024-07-03-162218.png",
        linkedin: "https://www.linkedin.com/in/",
        email: "dennis@corporateaisolutions.com",
        bio: "Operator, builder, and advisor across modular construction and AI‑enabled platforms. Focused on pragmatic automation and measurable outcomes."
      }
    ];

    const STORAGE_KEY = "cais_experts_local";

    // ===== DOM refs =====
    const grid = document.getElementById('grid');
    const search = document.getElementById('search');
    const createPanel = document.getElementById('create-panel');
    const adminBtn = document.getElementById('adminUnlockBtn');
    const inviteBtn = document.getElementById('inviteUnlockBtn');
    const adminBar = document.getElementById('adminUnlockBar');
    const inviteBar = document.getElementById('inviteUnlockBar');
    const adminPassEl = document.getElementById('adminPass');
    const adminGo = document.getElementById('adminPassGo');
    const adminStatus = document.getElementById('adminStatus');
    const inviteEl = document.getElementById('inviteCode');
    const inviteGo = document.getElementById('inviteGo');
    const inviteStatus = document.getElementById('inviteStatus');
    const profileCreationSection = document.getElementById('profileCreationSection');
    const generatedProfileForm = document.getElementById('generatedProfileForm');
    const adminTools = document.getElementById('adminTools');
    const localCount = document.getElementById('localCount');

    // ===== Global variables =====
    let currentFormTab = 'basic';
    let currentImageTab = 'upload';
    let selectedImageUrl = null;
    let currentProfile = {};

    // ===== Utility functions =====
    function setCookie(n,v,days=7){ const d=new Date(); d.setTime(d.getTime()+days*864e5); document.cookie=`${n}=${v};expires=${d.toUTCString()};path=/;SameSite=Lax`; }
    function getCookie(n){ return document.cookie.split('; ').find(r=>r.startsWith(n+'='))?.split('=')[1]; }
    async function sha256Hex(t){ const buf=new TextEncoder().encode(t); const hash=await crypto.subtle.digest('SHA-256', buf); return [...new Uint8Array(hash)].map(b=>b.toString(16).padStart(2,'0')).join(''); }

    // ===== Config: replace with your hashes =====
    const ADMIN_PASS_HASH = "sha256:8e48abd0c30b9f37ecca437da9749e85a0b4399bf5161f9aa840492054b41e8e";
    const INVITE_CODE_HASH = "sha256:d67653f1ff3ca9ff79bfed8b0fba1d9513fe9ffaf16b1377aed838d28e3e35a9";

    // ===== AI Profile Generation =====
    async function generateAIProfile() {
      const content = document.getElementById('linkedinContent').value.trim();
      if (!content) {
        alert('Please paste your LinkedIn profile content first!');
        return;
      }

      const generateBtn = document.getElementById('generateBtn');
      const loadingIndicator = document.getElementById('loadingIndicator');
      
      // Show loading state
      generateBtn.style.display = 'none';
      loadingIndicator.style.display = 'flex';

      try {
        const response = await fetch('/api/generate-profile', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            linkedinContent: content
          })
        });

        if (!response.ok) {
          const error = await response.json();
          throw new Error(error.error || 'Failed to generate profile');
        }

        const generatedData = await response.json();
        
        // Populate the AI form with results
        document.getElementById('ai_name').value = generatedData.name || '';
        document.getElementById('ai_title').value = generatedData.title || '';
        document.getElementById('ai_expertise').value = Array.isArray(generatedData.expertise) ? generatedData.expertise.join(', ') : generatedData.expertise || '';
        document.getElementById('ai_bio').value = generatedData.bio || '';
        document.getElementById('ai_linkedin').value = generatedData.linkedin || '';
        document.getElementById('ai_email').value = generatedData.email || '';
        document.getElementById('ai_photo').value = '';

        // Show the generated profile form
        generatedProfileForm.style.display = 'block';
        
        // Scroll to the generated profile
        generatedProfileForm.scrollIntoView({ behavior: 'smooth' });

      } catch (error) {
        console.error('AI Generation Error:', error);
        alert('AI generation failed: ' + error.message + '\n\nYou can try again or use manual entry below.');
        showManualEntry();
      } finally {
        // Hide loading state
        generateBtn.style.display = 'inline-flex';
        loadingIndicator.style.display = 'none';
      }
    }

    async function regenerateAIProfile() {
      if (confirm('This will regenerate your profile with a different focus. Continue?')) {
        await generateAIProfile();
      }
    }

    function showManualEntry() {
      document.getElementById('manualEntrySection').style.display = 'block';
      document.getElementById('manualEntrySection').scrollIntoView({ behavior: 'smooth' });
    }

    function openLinkedIn() {
      window.open('https://www.linkedin.com', '_blank');
      setTimeout(() => {
        alert('💡 Tip: Go to your LinkedIn profile, press Ctrl+A (or Cmd+A) to select all text, then Ctrl+C (or Cmd+C) to copy. Come back and paste in the text area!');
      }, 1000);
    }

    // ===== Tab Management =====
    function switchFormTab(tabName) {
      // Update tab buttons
      document.querySelectorAll('#generatedProfileForm .tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.textContent.includes(getTabDisplayName(tabName))) {
          tab.classList.add('active');
        }
      });
      
      // Update tab content
      document.querySelectorAll('#generatedProfileForm .tab-content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById(tabName + '-tab').classList.add('active');
      
      currentFormTab = tabName;

      // Auto-generate preview when switching to preview tab
      if (tabName === 'preview') {
        generatePreview();
      }
    }

    function getTabDisplayName(tabName) {
      const names = {
        'basic': '📝 Basic Info',
        'image': '🖼️ Profile Image', 
        'preview': '👀 Preview'
      };
      return names[tabName] || tabName;
    }

    function switchImageTab(tabName) {
      // Update image tab buttons
      document.querySelectorAll('#image-tab .tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.textContent.includes(getImageTabDisplayName(tabName))) {
          tab.classList.add('active');
        }
      });
      
      // Update image tab content
      document.querySelectorAll('#image-tab .tab-content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById(tabName + '-img-tab').classList.add('active');
      
      currentImageTab = tabName;
    }

    function getImageTabDisplayName(tabName) {
      const names = {
        'upload': '📁 Upload',
        'generate': '🎨 Generate',
        'url': '🔗 URL'
      };
      return names[tabName] || tabName;
    }

    // ===== Image Management =====
    function handleFileSelect(event) {
      const file = event.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = (e) => {
          document.getElementById('previewImg').src = e.target.result;
          document.getElementById('uploadContent').classList.add('hidden');
          document.getElementById('imagePreview').classList.remove('hidden');
          selectedImageUrl = e.target.result;
          document.getElementById('ai_photo').value = e.target.result;
        };
        reader.readAsDataURL(file);
      }
    }

    // Drag and drop
    const uploadZone = document.getElementById('uploadZone');
    if (uploadZone) {
      uploadZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadZone.classList.add('dragover');
      });
      uploadZone.addEventListener('dragleave', () => {
        uploadZone.classList.remove('dragover');
      });
      uploadZone.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadZone.classList.remove('dragover');
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          const event = { target: { files: files } };
          handleFileSelect(event);
        }
      });
    }

    function generateAvatars() {
      const initials = document.getElementById('initialsInput').value.toUpperCase().slice(0, 3);
      if (!initials) {
        alert('Please enter your initials');
        return;
      }

      const colors = [
        { bg: '#60a5fa', text: '#020617' },
        { bg: '#22d3ee', text: '#020617' },
        { bg: '#a78bfa', text: '#fff' },
        { bg: '#f59e0b', text: '#020617' },
        { bg: '#10b981', text: '#fff' },
        { bg: '#ef4444', text: '#fff' }
      ];

      const container = document.getElementById('avatarOptions');
      container.innerHTML = '';

      colors.forEach(color => {
        const canvas = document.createElement('canvas');
        canvas.width = 200;
        canvas.height = 200;
        const ctx = canvas.getContext('2d');
        
        ctx.fillStyle = color.bg;
        ctx.fillRect(0, 0, 200, 200);
        ctx.fillStyle = color.text;
        ctx.font = 'bold 80px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(initials, 100, 100);

        const img = document.createElement('img');
        img.src = canvas.toDataURL();
        img.className = 'avatar-option';
        img.onclick = () => {
          document.querySelectorAll('.avatar-option').forEach(av => av.classList.remove('selected'));
          img.classList.add('selected');
          selectedImageUrl = img.src;
          document.getElementById('ai_photo').value = img.src;
        };
        container.appendChild(img);
      });
    }

    function testPhotoUrl() {
      const url = document.getElementById('photoUrlInput').value;
      if (!url) {
        alert('Please enter a photo URL');
        return;
      }

      const img = document.getElementById('urlPreviewImg');
      img.onload = () => {
        document.getElementById('urlPreview').classList.remove('hidden');
        selectedImageUrl = url;
        document.getElementById('ai_photo').value = url;
      };
      img.onerror = () => {
        alert('Could not load image from URL. Please check the URL.');
      };
      img.src = url;
    }

    // ===== Preview Generation =====
    function generatePreview() {
      currentProfile = {
        name: document.getElementById('ai_name').value || 'Your Name',
        title: document.getElementById('ai_title').value || 'Your Title',
        expertise: document.getElementById('ai_expertise').value.split(',').map(s => s.trim()).filter(Boolean),
        bio: document.getElementById('ai_bio').value || 'Your bio will appear here.',
        linkedin: document.getElementById('ai_linkedin').value,
        email: document.getElementById('ai_email').value,
        photo: document.getElementById('ai_photo').value || 'https://via.placeholder.com/120x120?text=Photo'
      };

      const expertiseTags = currentProfile.expertise.map(exp => `<span class="tag">${exp}</span>`).join(' ');
      const linkedinLink = currentProfile.linkedin ? `<a href="${currentProfile.linkedin}" target="_blank" style="color:var(--brand)">🔗 LinkedIn</a>` : '';
      const emailLink = currentProfile.email ? `<a href="mailto:${currentProfile.email}" style="color:var(--brand)">✉️ Email</a>` : '';

      document.getElementById('profilePreviewContent').innerHTML = `
        <div style="display:flex; gap:20px; align-items:flex-start; background:rgba(17,24,39,.5); padding:20px; border-radius:12px;">
          <img src="${currentProfile.photo}" alt="${currentProfile.name}" style="width:120px; height:120px; border-radius:12px; object-fit:cover; background:#333;">
          <div style="flex:1;">
            <h4 style="margin:0 0 6px; color:var(--headline); font-size:20px;">${currentProfile.name}</h4>
            <p style="margin:0 0 12px; color:var(--muted); font-size:16px;">${currentProfile.title}</p>
            <div style="margin:12px 0;">${expertiseTags}</div>
            <p style="margin:12px 0; font-size:15px; line-height:1.5;">${currentProfile.bio}</p>
            <div style="display:flex; gap:16px; margin-top:16px;">
              ${linkedinLink} ${emailLink}
            </div>
          </div>
        </div>
      `;
    }

    function previewManualProfile() {
      currentProfile = {
        name: document.getElementById('manual_name').value || 'Your Name',
        title: document.getElementById('manual_title').value || 'Your Title',
        expertise: document.getElementById('manual_expertise').value.split(',').map(s => s.trim()).filter(Boolean),
        bio: document.getElementById('manual_bio').value || 'Your bio will appear here.',
        linkedin: document.getElementById('manual_linkedin').value,
        email: document.getElementById('manual_email').value,
        photo: document.getElementById('manual_photo').value || 'https://via.placeholder.com/120x120?text=Photo'
      };
      
      // Use the same preview generation
      const previewContent = document.getElementById('profilePreviewContent');
      generatePreview();
      document.getElementById('generatedProfileForm').style.display = 'block';
      switchFormTab('preview');
    }

    function finalizeProfile() {
      if (!currentProfile.name || !currentProfile.title) {
        alert('Please fill in at least name and title before finalizing.');
        return;
      }

      const locals = loadLocal();
      locals.unshift(currentProfile);
      saveLocal(locals);
      refresh();
      
      alert('✅ Profile added successfully!\n\nYour expert profile has been added to the local preview. In a real deployment, this would be sent to the server.');
      
      // Reset form
      startOver();
      
      // Scroll to the experts section
      document.getElementById('experts').scrollIntoView({ behavior: 'smooth' });
    }

    function copyProfileJSON() {
      const json = JSON.stringify(currentProfile, null, 2);
      navigator.clipboard.writeText(json).then(() => {
        alert('📋 Profile JSON copied to clipboard!');
      });
    }

    function startOver() {
      // Reset all forms
      document.getElementById('linkedinContent').value = '';
      document.getElementById('generatedProfileForm').style.display = 'none';
      document.getElementById('manualEntrySection').style.display = 'none';
      
      // Clear AI form
      ['ai_name', 'ai_title', 'ai_expertise', 'ai_bio', 'ai_linkedin', 'ai_email', 'ai_photo'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = '';
      });
      
      // Clear manual form  
      ['manual_name', 'manual_title', 'manual_expertise', 'manual_bio', 'manual_linkedin', 'manual_email', 'manual_photo'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = '';
      });
      
      // Reset image upload
      resetImageUpload();
      
      // Reset to first tab
      switchFormTab('basic');
    }

    function resetImageUpload() {
      const fileInput = document.getElementById('fileInput');
      if (fileInput) fileInput.value = '';
      
      const uploadContent = document.getElementById('uploadContent');
      const imagePreview = document.getElementById('imagePreview');
      if (uploadContent) uploadContent.classList.remove('hidden');
      if (imagePreview) imagePreview.classList.add('hidden');
      
      selectedImageUrl = null;
    }

    // ===== Expert Display Functions =====
    function cardTemplate(x, idx, isAdmin){
      const tags = x.expertise.map(t => `<span class="tag">${t}</span>`).join('');
      const linkedin = x.linkedin ? `<a class="link" href="${x.linkedin}" target="_blank" rel="noopener" aria-label="LinkedIn profile for ${x.name}">🔗 LinkedIn</a>` : '';
      const email = x.email ? `<a class="link" href="mailto:${x.email}" aria-label="Email ${x.name}">✉️ Email</a>` : '';
      const adminX = isAdmin ? `<button class="link danger" data-remove="${idx}" title="Remove (local)">🗑 Remove</button>` : '';
      return `
        <article class="card">
          <div class="head">
            <img class="avatar" src="${x.photo}" alt="Headshot of ${x.name}" loading="lazy" decoding="async"/>
            <div>
              <div class="name">${x.name}</div>
              <div class="title">${x.title}</div>
            </div>
          </div>
          <div class="tags">${tags}</div>
          <p class="bio">${x.bio}</p>
          <div class="links">${linkedin}${email}${adminX}</div>
        </article>
      `;
    }

    function matches(x, q){
      const hay = (x.name + ' ' + x.title + ' ' + x.expertise.join(' ') + ' ' + x.bio).toLowerCase();
      return hay.includes(q.toLowerCase());
    }

    function loadLocal(){
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]'); } catch { return []; }
    }
    function saveLocal(arr){ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }

    function getMerged(){
      const locals = loadLocal();
      localCount.textContent = String(locals.length);
      return [...locals, ...BASE_EXPERTS];
    }

    function render(list){
      const isAdmin = getCookie('cais_admin') === '1';
      grid.innerHTML = list.map((x, i)=> cardTemplate(x, i, isAdmin)).join('');
      if (isAdmin) {
        grid.querySelectorAll('[data-remove]').forEach(btn => {
          btn.addEventListener('click', (e)=>{
            const idx = Number(e.currentTarget.getAttribute('data-remove'));
            const locals = loadLocal();
            if (idx < locals.length) {
              locals.splice(idx,1);
              saveLocal(locals);
              refresh();
            } else {
              alert('Only locally added preview cards can be removed here.');
            }
          });
        });
      }
    }

    function refresh(){
      const q = search.value.trim();
      const merged = getMerged();
      render(q ? merged.filter(x => matches(x, q)) : merged);
    }

    // ===== Unlock Logic =====
    const qp = new URLSearchParams(location.search);
    const isAdminQuery = qp.get('admin') === '1';

    (function initUnlock(){
      const adminCookie = getCookie('cais_admin');
      const inviteCookie = getCookie('cais_invited');
      if (adminCookie === '1') showAdminUI();
      else if (inviteCookie === '1') showInviteUI();
      else if (isAdminQuery) { createPanel.style.display = 'block'; adminBar.style.display = 'block'; }
      else createPanel.style.display = 'block';
    })();

    adminBtn.addEventListener('click', ()=> { createPanel.style.display='block'; adminBar.style.display='flex'; inviteBar.style.display='none'; });
    inviteBtn.addEventListener('click', ()=> { createPanel.style.display='block'; inviteBar.style.display='flex'; adminBar.style.display='none'; });

    adminGo.addEventListener('click', async ()=>{
      const pass = adminPassEl.value.trim();
      const hex = await sha256Hex(pass);
      if ('sha256:'+hex === ADMIN_PASS_HASH){
        setCookie('cais_admin','1');
        showAdminUI();
        adminStatus.textContent = 'Unlocked (Admin)';
      } else {
        adminStatus.textContent = 'Incorrect passcode.';
      }
    });

    inviteGo.addEventListener('click', async ()=>{
      const code = inviteEl.value.trim();
      const hex = await sha256Hex(code);
      if ('sha256:'+hex === INVITE_CODE_HASH){
        setCookie('cais_invited','1');
        showInviteUI();
        inviteStatus.textContent = 'Invite accepted.';
      } else {
        inviteStatus.textContent = 'Invalid code.';
      }
    });

    function showAdminUI(){
      createPanel.style.display = 'block';
      adminBar.style.display = 'none';
      inviteBar.style.display = 'none';
      profileCreationSection.style.display = 'block';
      adminTools.style.display = 'block';
      refresh();
    }
    
    function showInviteUI(){
      createPanel.style.display = 'block';
      profileCreationSection.style.display = 'block';
      adminTools.style.display = 'none';
      refresh();
    }

    // ===== Event Listeners =====
    search.addEventListener('input', refresh);

    // Export functions for admin
    document.getElementById('exportAllBtn')?.addEventListener('click', ()=>{
      const all = getMerged();
      const blob = new Blob([JSON.stringify(all,null,2)], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'experts_all.json';
      document.body.appendChild(a); a.click(); a.remove();
    });

    document.getElementById('clearLocalBtn')?.addEventListener('click', ()=>{
      if (confirm('Clear locally added preview cards?')){
        localStorage.removeItem(STORAGE_KEY);
        refresh();
      }
    });

    // Footer year
    document.getElementById('y').textContent = new Date().getFullYear();

    // Initialize
    refresh();
  </script>
</body>
</html>